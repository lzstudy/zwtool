
.global _start

/**************************************************************************************************
 * @brief  : 程序入口
 * @param  : None
 * @return : None
**************************************************************************************************/
_start:
    bl set_clock
    bl set_mux
    bl set_pad
    bl set_gpio
    bl led_on
    bl c_env

loop:
    b loop


/**************************************************************************************************
 * @brief  : 配置时钟功能
 * @param  : None
 * @return : None
**************************************************************************************************/
set_clock:
	ldr r0, =0x020C4068 	/* CCGR0 */
	ldr r1, =0xFFFFFFFF  
	str r1, [r0]

	ldr r0, =0x020C406C  	/* CCGR1 */
	str r1, [r0]

	ldr r0, =0x020C4070  	/* CCGR2 */
	str r1, [r0]
	
	ldr r0, =0x020C4074  	/* CCGR3 */
	str r1, [r0]
	
	ldr r0, =0x020C4078  	/* CCGR4 */
	str r1, [r0]
	
	ldr r0, =0x020C407C  	/* CCGR5 */
	str r1, [r0]
	
	ldr r0, =0x020C4080  	/* CCGR6 */
	str r1, [r0]

/**************************************************************************************************
 * @brief  : 配置MUX功能
 * @param  : None
 * @return : None
**************************************************************************************************/
set_mux:
    ldr r0, =0x020E0068
    ldr r1, =0x5
    str r1,[r0]

/**************************************************************************************************
 * @brief  : 配置PAD功能
 * @param  : None
 * @return : None
**************************************************************************************************/
set_pad:
    ldr r0, =0x020E02F4
    ldr r1, =0x10B0
    str r1,[r0]

/**************************************************************************************************
 * @brief  : 配置GPIO功能, 设置方向为输出
 * @param  : None
 * @return : None
**************************************************************************************************/
set_gpio:
    ldr r0, =0x0209C004
    ldr r1, =0x0000008	
    str r1,[r0]

/**************************************************************************************************
 * @brief  : led控制
 * @param  : None
 * @return : None
**************************************************************************************************/
led_on:
    ldr r0, =0x0209C000
    ldr r1, =1	
    str r1,[r0]

/**************************************************************************************************
 * @brief  : led控制
 * @param  : None
 * @return : None
**************************************************************************************************/
led_off:
    ldr r0, =0x0209C000
    ldr r1, =1	
    str r1,[r0]

/**************************************************************************************************
 * @brief  : 设置SVC模式进入C环境
 * @param  : None
 * @return : None
**************************************************************************************************/
c_env:
    mrs r0, cpsr
    bic r0, r0, #0x1f
    orr r0, r0, #0x13
    msr cpsr, r0

    ldr sp, =0x80200000
    b main
